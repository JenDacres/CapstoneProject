<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Gym Booking Calendar</title>
  <link rel="stylesheet" href="calendar.css" />
</head>
<body>
  <div class="calendar-container">
    <div class="calendar-header">
      <h1 id="calendar-year" onclick="toggleYearPicker()">2024</h1>
      <div class="view-switcher">
        <button onclick="setView('day')">Day</button>
        <button onclick="setView('week')">Week</button>
        <button onclick="setView('month')">Month</button>
      </div>
    </div>

    <div class="calendar-controls">
      <button id="prev-btn">‹</button>
      <h2 id="current-label">Today</h2>
      <button id="next-btn">›</button>
    </div>

    <div class="calendar-view fade" id="calendar-view"></div>
  </div>

  <script>
        const viewEl = document.getElementById("calendar-view");
        const labelEl = document.getElementById("current-label");
        const yearEl = document.getElementById("calendar-year");

        let viewMode = 'day';
        let currentDate = new Date();
        let isYearPickerOpen = false;
        let yearPickerYear = currentDate.getFullYear();

        function setView(mode) {
        viewMode = mode;
        isYearPickerOpen = false;
        renderCalendar();
        }

        document.getElementById("prev-btn").onclick = () => {
        if (viewMode === "day") currentDate.setDate(currentDate.getDate() - 1);
        else if (viewMode === "week") currentDate.setDate(currentDate.getDate() - 7);
        else if (viewMode === "month") currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar();
        };

        document.getElementById("next-btn").onclick = () => {
        if (viewMode === "day") currentDate.setDate(currentDate.getDate() + 1);
        else if (viewMode === "week") currentDate.setDate(currentDate.getDate() + 7);
        else if (viewMode === "month") currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar();
        };

        function formatDate(date, options = {}) {
        return date.toLocaleDateString(undefined, options);
        }

        function toggleYearPicker() {
        isYearPickerOpen = !isYearPickerOpen;
        if (isYearPickerOpen) {
            yearPickerYear = currentDate.getFullYear();
            renderYearPicker();
        } else {
            renderCalendar();
        }
        }

        function renderCalendar() {
        viewEl.innerHTML = '';
        viewEl.classList.add("fade");
        yearEl.textContent = currentDate.getFullYear();

        if (viewMode === "day") {
            labelEl.textContent = formatDate(currentDate, { weekday: 'long', month: 'short', day: 'numeric' });
            renderDayView(currentDate);
        } else if (viewMode === "week") {
            const start = new Date(currentDate);
            start.setDate(start.getDate() - start.getDay() + 1);
            const end = new Date(start);
            end.setDate(end.getDate() + 6);
            labelEl.textContent = `Week of ${formatDate(start)} - ${formatDate(end)}`;
            renderWeekView(start);
        } else if (viewMode === "month") {
            labelEl.textContent = formatDate(currentDate, { month: 'long', year: 'numeric' });
            renderMonthView(currentDate);
        }
        }

        function renderDayView(date) {
        const slots = generateSlotsForDay(date);
        slots.forEach(time => {
            const div = document.createElement("div");
            div.className = "slot";
            div.textContent = time;
            div.onclick = () => alert(`Booked ${time} on ${date.toDateString()}`);
            viewEl.appendChild(div);
        });
        }

        function renderWeekView(startDate) {
        for (let i = 0; i < 7; i++) {
            const day = new Date(startDate);
            day.setDate(startDate.getDate() + i);
            const div = document.createElement("div");
            div.className = "slot";
            div.textContent = formatDate(day, { weekday: 'short', day: 'numeric' });
            viewEl.appendChild(div);
        }
        }

        function renderMonthView(date) {
        const firstDay = new Date(date.getFullYear(), date.getMonth(), 1);
        const daysInMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();

        for (let d = 1; d <= daysInMonth; d++) {
            const day = new Date(date.getFullYear(), date.getMonth(), d);
            const div = document.createElement("div");
            div.className = "slot";
            div.textContent = formatDate(day, { day: 'numeric', weekday: 'short' });
            viewEl.appendChild(div);
        }
        }

        function renderYearPicker() {
        viewEl.innerHTML = '';
        viewEl.classList.add("fade");
        yearEl.textContent = `${yearPickerYear}`;

        const header = document.createElement('div');
        header.className = 'year-header';

        const prevBtn = document.createElement('button');
        prevBtn.className = 'year-nav';
        prevBtn.textContent = '‹';
        prevBtn.onclick = () => {
            yearPickerYear--;
            renderYearPicker();
        };

        const yearTitle = document.createElement('h2');
        yearTitle.textContent = yearPickerYear;

        const nextBtn = document.createElement('button');
        nextBtn.className = 'year-nav';
        nextBtn.textContent = '›';
        nextBtn.onclick = () => {
            yearPickerYear++;
            renderYearPicker();
        };

        header.appendChild(prevBtn);
        header.appendChild(yearTitle);
        header.appendChild(nextBtn);
        viewEl.appendChild(header);

        const months = [
            "January", "February", "March", "April",
            "May", "June", "July", "August",
            "September", "October", "November", "December"
        ];

        const grid = document.createElement('div');
        grid.className = 'year-picker';

        months.forEach((month, i) => {
            const box = document.createElement('div');
            box.className = 'month-box';
            box.textContent = month;
            box.onclick = () => {
            currentDate.setFullYear(yearPickerYear);
            currentDate.setMonth(i);
            isYearPickerOpen = false;
            setView('month');
            };
            grid.appendChild(box);
        });

        viewEl.appendChild(grid);
        }

        function generateSlotsForDay(date) {
        const day = date.getDay();
        const slots = [];

        let start = 5;
        let end = 23;
        if (day === 6) { start = 9; end = 22; }
        else if (day === 0) return [];

        for (let hour = start; hour < end; hour++) {
            slots.push(`${hour}:00 - ${hour + 1}:00`);
        }

        return slots;
        }

        // Initial render
        renderCalendar();

  </script>
</body>
</html>
